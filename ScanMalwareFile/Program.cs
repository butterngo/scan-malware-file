using Infrastructure.Extensions;
using System;

namespace ScanMalwareFile
{
    class Program
    {

        static void Main(string[] args)
        {
            //string pathFile = $@"D:\dev\nClam\files\MyCV.docx";
            string pathFile = $@"D:\dev\nClam\files\eicar.com";

            AzureAntiMalware(pathFile);

            //Clamav(pathFile);

            Console.ReadLine();
        }

        static void AzureAntiMalware(string pathFile)
        {
            Console.WriteLine("Start scan file with AzureAntiMalware");

            var clamav = new AzureAntiMalware.ClientScanFileService("<Your-Host-APIScanMalware>");

            var result = clamav.ScanFileAsync(pathFile.ToBytes()).Result;

            Console.WriteLine($"Has virus: {result.HasVirus}");

            Console.WriteLine($"VirusName: {result.VirusName}");

            Console.WriteLine($"Message: {result.Message}");
        }

        static void Clamav(string pathFile)
        {
            Console.WriteLine("Start scan file with Clamav");

            var clamav = new CLAMAV.ScanFileService("10.0.75.1", 3310);

            var result = clamav.ScanFileAsync(pathFile).Result;

            Console.WriteLine($"Has virus: {result.HasVirus}");

            Console.WriteLine($"VirusName: {result.VirusName}");

            Console.WriteLine($"Message: {result.Message}");
        }
    }
}
