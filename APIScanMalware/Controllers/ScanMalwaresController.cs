namespace APIScanMalware.Controllers
{
    using System.Threading.Tasks;
    using AzureAntiMalware;
    using Infrastructure.Models;
    using Microsoft.AspNetCore.Http;
    using Microsoft.AspNetCore.Mvc;

    [Route("[controller]")]
    [ApiController]
    public class ScanMalwaresController : ControllerBase
    {
        private readonly ServerScanFileService _serverScanFileService;

        public ScanMalwaresController() 
        {
            _serverScanFileService = new ServerScanFileService();
        }

        [HttpPost("")]
        public async Task<ActionResult<ScanResultModel>> ScanFile(IFormFile file)
        {
            return await _serverScanFileService.ScanFileAsync(file.OpenReadStream());
        }

        [HttpGet("")]
        public ActionResult<bool> Get()
        {
            return true;
        }
    }
}
